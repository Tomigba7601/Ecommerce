(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{4941:function(e,r,n){"use strict";n.d(r,{Z:function(){return L}});var t=n(5893),a=n(7757),s=n.n(a),i=n(2137),o=n(7294),l=n(9008),c=n(1664),d=n(7850),u=n(3457),h=n(5834),f=n(5258),p=n(8358),m=n(46),x=n(7812),j=n(9659),g=n(2318),Z=n(2764),b=n(2822),v=n(998),y=n(5517),w=n(5757),k=n(4741),P=n(9570),O=n(9009),C=n(282),N=n(5675),S=n(5639),_=n(3832),E=n(8884),B=n(7298),I=n(8995),D=n(530),R=n(2236),T=n(5877),z=n(6808),A=n.n(z),W=n(1163),H=n(7328),q=n(9669),F=n.n(q);function L(e){var r=e.title,n=e.description,a=e.children,z=(0,W.useRouter)(),q=(0,o.useContext)(R.y),L=q.state,M=q.dispatch,U=L.darkMode,V=L.cart,Q=L.userInfo,G=(0,d.A)({typography:{h1:{fontSize:"1.6rem",fontWeight:400,margin:"1rem 0"},h2:{fontSize:"1.4rem",fontWeight:400,margin:"1rem 0"}},palette:{type:U?"dark":"light",primary:{main:"#f0c000"},secondary:{main:"#208080"}}}),K=(0,D.Z)(),X=(0,o.useState)(!1),$=X[0],J=X[1],Y=function(){J(!1)},ee=(0,o.useState)([]),re=ee[0],ne=ee[1],te=(0,H.Ds)().enqueueSnackbar,ae=function(){var e=(0,i.Z)(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F().get("/api/products/categories");case 3:r=e.sent,n=r.data,ne(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),te((0,T.b)(e.t0),{variant:"error"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),se=(0,o.useState)(""),ie=se[0],oe=se[1];(0,o.useEffect)((function(){ae()}),[]);var le=(0,o.useState)(null),ce=le[0],de=le[1],ue=function(e,r){de(null),r&&z.push(r)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.default,{children:[(0,t.jsx)("title",{children:r?"".concat(r," - Next Amazona"):"Next Amazona"}),n&&(0,t.jsx)("meta",{name:"description",content:n})]}),(0,t.jsxs)(u.Z,{theme:G,children:[(0,t.jsx)(h.ZP,{}),(0,t.jsx)(f.Z,{position:"static",className:K.navbar,children:(0,t.jsxs)(p.Z,{className:K.toolbar,children:[(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",children:[(0,t.jsx)(x.Z,{edge:"start","aria-label":"open drawer",onClick:function(){J(!0)},className:K.menuButton,children:(0,t.jsx)(E.Z,{className:K.navbarButton})}),(0,t.jsx)(c.default,{href:"/",passHref:!0,children:(0,t.jsx)(j.Z,{children:(0,t.jsx)(g.Z,{className:K.brand,children:"amazona"})})})]}),(0,t.jsx)(Z.ZP,{anchor:"left",open:$,onClose:Y,children:(0,t.jsxs)(b.Z,{children:[(0,t.jsx)(v.Z,{children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,t.jsx)(g.Z,{children:"Shopping by category"}),(0,t.jsx)(x.Z,{"aria-label":"close",onClick:Y,children:(0,t.jsx)(B.Z,{})})]})}),(0,t.jsx)(y.Z,{light:!0}),re.map((function(e){return(0,t.jsx)(c.default,{href:"/search?category=".concat(e),passHref:!0,children:(0,t.jsx)(v.Z,{button:!0,component:"a",onClick:Y,children:(0,t.jsx)(w.Z,{primary:e})})},e)}))]})}),(0,t.jsx)("div",{className:K.searchSection,children:(0,t.jsxs)("form",{onSubmit:function(e){e.preventDefault(),z.push("/search?query=".concat(ie))},className:K.searchForm,children:[(0,t.jsx)(k.Z,{name:"query",className:K.searchInput,placeholder:"Search products",onChange:function(e){oe(e.target.value)}}),(0,t.jsx)(x.Z,{type:"submit",className:K.iconButton,"aria-label":"search",children:(0,t.jsx)(I.Z,{})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(P.Z,{checked:U,onChange:function(){M({type:U?"DARK_MODE_OFF":"DARK_MODE_ON"});var e=!U;A().set("darkMode",e?"ON":"OFF")}}),(0,t.jsx)(c.default,{href:"/cart",passHref:!0,children:(0,t.jsx)(j.Z,{children:(0,t.jsx)(g.Z,{component:"span",children:V.cartItems.length>0?(0,t.jsx)(O.Z,{color:"secondary",badgeContent:V.cartItems.length,children:"Cart"}):"Cart"})})}),Q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Z,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){de(e.currentTarget)},className:K.navbarButton,children:Q.name}),(0,t.jsxs)(N.Z,{id:"simple-menu",anchorEl:ce,keepMounted:!0,open:Boolean(ce),onClose:ue,children:[(0,t.jsx)(S.Z,{onClick:function(e){return ue(0,"/profile")},children:"Profile"}),(0,t.jsx)(S.Z,{onClick:function(e){return ue(0,"/order-history")},children:"Order Hisotry"}),Q.isAdmin&&(0,t.jsx)(S.Z,{onClick:function(e){return ue(0,"/admin/dashboard")},children:"Admin Dashboard"}),(0,t.jsx)(S.Z,{onClick:function(){de(null),M({type:"USER_LOGOUT"}),A().remove("userInfo"),A().remove("cartItems"),A().remove("shippinhAddress"),A().remove("paymentMethod"),z.push("/")},children:"Logout"})]})]}):(0,t.jsx)(c.default,{href:"/login",passHref:!0,children:(0,t.jsx)(j.Z,{children:(0,t.jsx)(g.Z,{component:"span",children:"Login"})})})]})]})}),(0,t.jsx)(_.Z,{className:K.main,children:a}),(0,t.jsx)("footer",{className:K.footer,children:(0,t.jsx)(g.Z,{children:"All rights reserved. Next Amazona."})})]})]})}},2310:function(e,r,n){"use strict";n.r(r);var t=n(6156),a=n(5893),s=n(7757),i=n.n(s),o=n(2137),l=n(9669),c=n.n(l),d=n(5152),u=n(1163),h=n(1664),f=n(7294),p=n(1749),m=n(8463),x=n(2822),j=n(998),g=n(5757),Z=n(2318),b=n(7784),v=n(282),y=n(5877),w=n(2236),k=n(4941),P=n(530),O=n(2283),C=n(7328),N=n(6808),S=n.n(N);function _(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function E(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?_(Object(n),!0).forEach((function(r){(0,t.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function B(){var e=(0,f.useContext)(w.y),r=e.state,n=e.dispatch,t=(0,O.cI)(),s=t.handleSubmit,l=t.control,d=t.formState.errors,N=t.setValue,_=(0,C.Ds)(),B=_.enqueueSnackbar,I=_.closeSnackbar,D=(0,u.useRouter)(),R=(0,P.Z)(),T=r.userInfo;(0,f.useEffect)((function(){if(!T)return D.push("/login");N("name",T.name),N("email",T.email)}),[]);var z=function(){var e=(0,o.Z)(i().mark((function e(r){var t,a,s,o,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.name,a=r.email,s=r.password,o=r.confirmPassword,I(),s===o){e.next=5;break}return B("Passwords don't match",{variant:"error"}),e.abrupt("return");case 5:return e.prev=5,e.next=8,c().put("/api/users/profile",{name:t,email:a,password:s},{headers:{authorization:"Bearer ".concat(T.token)}});case 8:l=e.sent,d=l.data,n({type:"USER_LOGIN",payload:d}),S().set("userInfo",d),B("Profile updated successfully",{variant:"success"}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),B((0,y.b)(e.t0),{variant:"error"});case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(r){return e.apply(this,arguments)}}();return(0,a.jsx)(k.Z,{title:"Profile",children:(0,a.jsxs)(p.Z,{container:!0,spacing:1,children:[(0,a.jsx)(p.Z,{item:!0,md:3,xs:12,children:(0,a.jsx)(m.Z,{className:R.section,children:(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(h.default,{href:"/profile",passHref:!0,children:(0,a.jsx)(j.Z,{selected:!0,button:!0,component:"a",children:(0,a.jsx)(g.Z,{primary:"User Profile"})})}),(0,a.jsx)(h.default,{href:"/order-history",passHref:!0,children:(0,a.jsx)(j.Z,{button:!0,component:"a",children:(0,a.jsx)(g.Z,{primary:"Order History"})})})]})})}),(0,a.jsx)(p.Z,{item:!0,md:9,xs:12,children:(0,a.jsx)(m.Z,{className:R.section,children:(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(j.Z,{children:(0,a.jsx)(Z.Z,{component:"h1",variant:"h1",children:"Profile"})}),(0,a.jsx)(j.Z,{children:(0,a.jsx)("form",{onSubmit:s(z),className:R.form,children:(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(j.Z,{children:(0,a.jsx)(O.Qr,{name:"name",control:l,defaultValue:"",rules:{required:!0,minLength:2},render:function(e){var r=e.field;return(0,a.jsx)(b.Z,E({variant:"outlined",fullWidth:!0,id:"name",label:"Name",inputProps:{type:"name"},error:Boolean(d.name),helperText:d.name?"minLength"===d.name.type?"Name length is more than 1":"Name is required":""},r))}})}),(0,a.jsx)(j.Z,{children:(0,a.jsx)(O.Qr,{name:"email",control:l,defaultValue:"",rules:{required:!0,pattern:/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/},render:function(e){var r=e.field;return(0,a.jsx)(b.Z,E({variant:"outlined",fullWidth:!0,id:"email",label:"Email",inputProps:{type:"email"},error:Boolean(d.email),helperText:d.email?"pattern"===d.email.type?"Email is not valid":"Email is required":""},r))}})}),(0,a.jsx)(j.Z,{children:(0,a.jsx)(O.Qr,{name:"password",control:l,defaultValue:"",rules:{validate:function(e){return""===e||e.length>5||"Password length is more than 5"}},render:function(e){var r=e.field;return(0,a.jsx)(b.Z,E({variant:"outlined",fullWidth:!0,id:"password",label:"Password",inputProps:{type:"password"},error:Boolean(d.password),helperText:d.password?"Password length is more than 5":""},r))}})}),(0,a.jsx)(j.Z,{children:(0,a.jsx)(O.Qr,{name:"confirmPassword",control:l,defaultValue:"",rules:{validate:function(e){return""===e||e.length>5||"Confirm Password length is more than 5"}},render:function(e){var r=e.field;return(0,a.jsx)(b.Z,E({variant:"outlined",fullWidth:!0,id:"confirmPassword",label:"Confirm Password",inputProps:{type:"password"},error:Boolean(d.confirmPassword),helperText:d.password?"Confirm Password length is more than 5":""},r))}})}),(0,a.jsx)(j.Z,{children:(0,a.jsx)(v.Z,{variant:"contained",type:"submit",fullWidth:!0,color:"primary",children:"Update"})})]})})})]})})})]})})}r.default=(0,d.default)((function(){return Promise.resolve(B)}),{ssr:!1})},5877:function(e,r,n){"use strict";n.d(r,{b:function(){return t}});n(7757),n(2137),n(6785),n(4155);var t=function(e){return e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message}},530:function(e,r,n){"use strict";var t=n(6156),a=(0,n(1120).Z)((function(e){return{navbar:{backgroundColor:"#203040","& a":{color:"#ffffff",marginLeft:10}},brand:{fontWeight:"bold",fontSize:"1.5rem"},grow:{flexGrow:1},main:{minHeight:"80vh"},footer:{marginTop:10,textAlign:"center"},section:{marginTop:10,marginBottom:10},form:{width:"100%",maxWidth:800,margin:"0 auto"},navbarButton:{color:"#ffffff",textTransform:"initial"},transparentBackgroud:{backgroundColor:"transparent"},error:{color:"#f04040"},fullWidth:{width:"100%"},reviewForm:{maxWidth:800,width:"100%"},reviewItem:{marginRight:"1rem",borderRight:"1px #808080 solid",paddingRight:"1rem"},toolbar:{justifyContent:"space-between"},menuButton:{padding:0},mt1:{marginTop:"1rem"},searchSection:(0,t.Z)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),searchForm:{border:"1px solid #ffffff",backgroundColor:"#ffffff",borderRadius:5},searchInput:{paddingLeft:5,color:"#000000","& ::placeholder":{color:"#606060"}},iconButton:{backgroundColor:"#f8c040",padding:5,borderRadius:"0 5px 5px 0","& span":{color:"#000000"}},sort:{marginRight:5},fullContainer:{height:"100vh"},mapInputBox:{position:"absolute",display:"flex",left:0,right:0,margin:"10px auto",width:300,height:40,"& input":{width:250}}}}));r.Z=a},3962:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return n(2310)}])}},function(e){e.O(0,[774,961,453,537,174,784,283,125,888,179],(function(){return r=3962,e(e.s=r);var r}));var r=e.O();_N_E=r}]);